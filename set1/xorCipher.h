#ifndef XORCIPHER_H
#define XORCIPHER_H

#include <cstddef>
#include <cstdint>


const int CHAR_SCORES[256] = {
	    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
	    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
	14000,    2,  285,    0,   52,    2,    7,  204,   53,   54,   21,    0,  985,  252,  946,    8,
	  546,  461,  333,  188,  193,  374,  154,  120,  183,  282,   54,   37,    0,    0,    0,   12,
	    0,  281,  169,  229,  130,  138,  101,   93,  124,  223,   79,   47,  107,  259,  205,  106,
	  144,   12,  146,  305,  325,   57,   31,  107,    8,   94,    6,    0,    0,    0,    0,    0,
	    0, 5264,  866, 1960, 2370, 7742, 1297, 1207, 2956, 4527,   66,  461, 2553, 1467, 4536, 4729,
	 1256,   54, 4138, 4186, 5508, 1613,  653, 1016,  124, 1062,   66,    0,    0,    0,    0,    0,
	    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
	    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
	    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
	    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
	    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
	    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
	    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
	    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0
};


void printResults(uint8_t* buffer, const size_t &len, uint8_t key, uint64_t score);
void findBestScoringKey(uint8_t* buffer, const size_t &len, uint64_t &maxScore);

#endif /* !XORCIPHER_H */
